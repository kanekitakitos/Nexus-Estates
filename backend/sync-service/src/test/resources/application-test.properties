# Base de Dados H2 em Memória para Testes
spring.datasource.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password

# Forçar Dialeto H2 para evitar deteção automática via conexão JDBC
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.H2Dialect

# Desativar Flyway em testes
spring.flyway.enabled=false

# Configurações Externas Mockadas
external.api.base-url=http://localhost

# Resilience4j - Circuit Breaker
resilience4j.circuitbreaker.instances.externalApi.slidingWindowSize=4
resilience4j.circuitbreaker.instances.externalApi.minimumNumberOfCalls=4
resilience4j.circuitbreaker.instances.externalApi.failureRateThreshold=50
resilience4j.circuitbreaker.instances.externalApi.waitDurationInOpenState=1s

# Resilience4j - Retry
resilience4j.retry.instances.externalApi.maxAttempts=2
resilience4j.retry.instances.externalApi.waitDuration=10ms
resilience4j.retry.instances.externalApi.enableExponentialBackoff=false

# Resilience4j - Aspect Order
resilience4j.retry.aspect.order=10
resilience4j.circuitbreaker.aspect.order=20
